# Simulated annealing on Cerebras WSE-2
This is a simulated annealing program.
It runs on the Cerebras WSE-2.
## Run
This program requires the [Cerebras SDK](https://sdk.cerebras.net).
```shell-session
$ command -v cslc cs_python # check SDK
/path/to/cslc
/path/to/cs_python
$ cd path/to/repo
$ cd src
$ ./commands.sh 
+ width=4
+ height=8
+ cslc ./layout.csl --fabric-dims=11,10 --fabric-offsets=4,1 --params=Num:6,width:4,height:8,max_iters:16,T:1000 --params=MEMCPYH2D_DATA_1_ID:0,MEMCPYD2H_DATA_1_ID:1 -o out --memcpy --channels 1
INFO: Using SIF: /home/tfukaya/cerebras/cbcore_sdk-202311111408-10-4a54bce5.sif
INFO: User's specified CSL_IMPORT_PATH=
NOTE: CSL_IMPORT_PATH accepts colon separated list of paths generated by 'realpath <path>'
INFO:    Converting SIF file to temporary sandbox...
INFO:    Cleaning up image...
compile successful
+ cs_python run.py --name out
INFO: Using SIF: /home/tfukaya/cerebras/cbcore_sdk-202311111408-10-4a54bce5.sif
INFO:    Converting SIF file to temporary sandbox...
Reading file out/out.json
Reading file out/west/out.json
Reading file out/east/out.json
fab w,h = 11,10
Kernel x,y w,h = 4,1 4,8
memcpy x,y w,h = 1,1 9,8
inputs = [ 0.5479121  -0.12224312  0.71719587  0.39473605 -0.8116453   0.9512447
  0.5222794   0.5721286  -0.74377275 -0.09922812 -0.25840396  0.85353
  0.28773025  0.64552325 -0.1131716  -0.5455226   0.10916957 -0.8723655
  0.65526235  0.2633288   0.5161755 ]
95.04355487s
best_s = [0 1 0 1 0 1]
energy = -1.3816108703613281
INFO:    Cleaning up image...
```

## License
Please read [LICENSE](LICENSE) and [NOTICE](NOTICE).

